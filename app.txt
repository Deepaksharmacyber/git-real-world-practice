Version 2
Improved login validation